# 文件管理
6.1 文件系统
1. 文件：文件系统中存储数据的一个命名对象，是用户中最小的逻辑存储单元。
2. Linux 操作系统中，所有的文件和目录都被组织成从一个 根节点“/” 开始的倒置的树状结
构。文件系统 __ 按名_ 访问文件。
6.1.2 文件结构和类型
1. 文件是 Linux 系统处理信息的基本单位，所有软件都组织成文件。所有文件都由两部分
组成，数据项和文件控制块。文件控制块被称为索引节点。
2. 根据文件数据项是否具有结构，可将文件分为两大类：无结构文件（即字符流文件）和
有结构文件（如目录文件）。但通常情况下，Linux 文件类型被划分为普通文件、目录文件、
链接文件及设备文件。
3. 说明目录或文件名位置的方法有两种，分别使用 _ 绝对路径__ 和 __ 相对路径_ 。前者指
的是从根目录(/)开始写起的文件或目录名称，而后者则指的是相对于当前路径的文件或目
录名称。
6.2 文件与目录操作
6.2.1 文件操作命令
1. concatenate 连接、连续
[root@localhost ~]# cat [ 选项 ] 文件名 ， 显示文件内容
-n 对输出的所有行进行编号
-b 只对非空行进行编号
或者
[root@localhost ~]# cat 文件 1 文件 2 > 文件 3，连接合并文件，file3 原内容会被覆盖，若
file3 不存在会自动创建。
2. 分页显示文本文件内容
[root@localhost ~]# more [ 选项 ] 文件名 ，
3. 显式指定文件的前若干行内容
[root@localhost ~]# head [ 选项 ] 文件名
-n k : k 表示行数，用来显示文件前 k 行的内容。
不设置显示的具体行数，则默认显示 10 行的文本数据。4
4. 查看文件末尾的数据
[root@localhost ~]# tail [ 选项 ] 文件名
-n k : k 表示行数，用来显示文件后 k 行的内容。
-k: 同上
-f : 用来监听文件的新增内容，若想中止按 Ctrl+C 键
5. 创建文件，修改文件时间参数
[root@localhost ~]# touch [ 选项 ] 文件名
-a：只修改文件访问时间 P171
4. grep 命令
global regular expressions print
在一个或多个文件中搜索某一特定的字符模式（即正则表达式），此模式可以是单一的
字符、字符串、单词或句子。正则表达式是描述一组字符串的一个模式，可以是一些
纯文本文字，也可以是用来产生模式的一些特殊字符。正则表达式中包含一些特殊字
符，与通配符含义不同。
c* 将匹配 0 个或多个字符 c（c 为任一字符）
.： 将匹配任何一个字符，且只能是一个字符。
[xyz]：匹配方括号中任意一个字符。
[^xyz]：匹配出方括号中字符外的所有字符。
^：行首定位符。
$：行尾定位符。
[root@localhost ~]# grep [ 选项 ] 模式 文件名
-n 在每一行的最前面列出行号
5. sed 命令
主要用来自动编辑一个或多个文件，简化对文件的反复操作，编写转换程序等。
[root@localhost ~]# sed [ 选项 ] sed 命令 文件名
选项：
-n：只显示匹配处理的行
-e：执行多个编辑命令时使用（一般用“；”代替）
-i：直接在文件中进行修改，而不是输出到显示器。
-f：从脚本文件中读取内容并执行（文件中的编辑命令每行一个，不用“；”隔开）
sed 常用编辑命令：
p：打印匹配行 print
d：删除指定行 delete
a：在匹配行后面追加 append
i：在匹配行前面插入 insert
c：整行替换
r：读取文件的内容
w：将文本写入文件
s：字符串替换（匹配正则表达式）substitution
6. awk 命令
更适合格式化文本，对文本进行较复杂的格式处理
[root@localhost ~]# awk [ 选项 ] ‘匹配规则|执行命令|’ 文件名
awk 的主要特性之一是其较强的处理文本文件中数据的能力，它会自动给一行中的每个数
据元素分配一个变量。默认情况下，将如下变量分配给它在文本行中发现的数据字段：
$0：代表整个文本行
$1：代表文本行中的第 1 个数据字段
$2：代表文本行中的第 2 个数据字段
$n：代表文本行中的第 n 个数据字段
在 awk 中默认字段分隔符是任意的空白字符，如空格或制表符。读取一行文本时，会用预
定于的字段分隔符划分每个数据字段。若要采用其他字段分隔符的文本，可以用-F 选项手
动指定。
[root@localhost ~]# awk ‘{print $1}‘ file
[root@localhost ~]# awk ‘BEGIN {print “The File Contents：“}> {print $0} END {print”End of
File”}‘ file
7. cp 命令
复制文件和目录，借助某些选项，还可复制整个目录
[root@localhost ~]# cp [选项] 源文件 目标文件
-a：相当于-d、-p、-r 选项的集合
-d：若源文件为软链接（对硬链接无效），则复制的目标文件也为软链接
-i：询问，若目标文件已经存在，则会询问是否覆盖
-l：把目标文件建立为源文件的硬链接文件，而不是复制源文件
-s：把目标文件建立为源文件的软链接文件，而不是复制源文件
-p：复制后目标文件保留原文件的属性
-r：递归复制，用于复制目录
目标表文件必须是目录。
把源文件不改名复制到/tmp/目录下：
[root@localhost ~]# cp file /tmp/
若需改名复制，如下：
[root@localhost ~]# cp file /tmp/text
提示是否覆盖：
[root@localhost ~]# cp -i file /tmp/text
8. rm 命令
永久性删除文件系统
[root@localhost ~]# rm [选项] 文件或目录
-f：强制删除 force
-i：删除前询问
-r：递归删除，主要用于删除目录，可删除指定目录及包含的所有内容。
9. mv 命令
可在不同目录间移动文件或目录，也可对文件和目录进行重命名。
[root@localhost ~]# mv [选项] 源文件 目标文件
-f：强制覆盖
-i：交互移动，若目标文件已经存在，询问用户是否覆盖（默认选项）
-n：若目标文件已经存在，则不会覆盖移动，而且不询问用户。
-v：显示文件或目录的移动过程。
-u：若目标文件已经存在，两者相比，源文件更新，则会对目标文件进行升级。
10. sort 命令
排序命令。ASCII 码值进行比较，升序输出。
-r 反向排序。
11. wc 命令 统计
-l：只统计行数
-w：只统计单词数
-m：只统计字符数
6.2.2 目录操作命令
1. mkdir 命令 make directories -m 用于手动配置所创建目录的权限，而不再使用默认权限。
-p 递归创建所有目录。
自定义目录权限
2. rmdir -p 递归删除空目录
3. cd 命令
change directory 切换工作目录。
特殊符号
~ ：代表当前登录用户的主目录
- ：代表上次所在目录
. ：代表当前目录
.. ：代表上级目录
cd ~ 命令的含义是 回到用户的（主）家目录
4.pwd 命令
print working directory 显示当前所在的目录。
5.ls 命令
显示当前目录下的内容。
不使用任何选项时，默认只会显示非隐藏文件的名称，并以文件名进行排序。
-a 显示全部的文件，包括隐藏文件。（开头为”.”的文件）
6.ln 命令
ln [选项] 源文件 目标文件
-s：创建软链接文件，不加则创建硬链接文件
硬链接：不是是修改源文件还是硬链接，另一个文件数据都会发生改变；硬链接不能跨文
件系统（分区）建立，不能链接目录。
软链接：相当于快捷方式，可跨分区，可链接目录。
使用 ln 命令生成了一个指向文件 old 的符号链接 new,如果将文件 old 删除，不可能再访
问文件中的数据
6.3 访问权限管理
可以使用 ls 命令查看文件和目录的权限信息，ls -al
6.3.2 权限位
文件权限有 3 种，对文件的读，写和执行权限。每行第一列为权限，一共 10 位，第 1 位表
示文件的具体类型。
6.3.2 修改权限位的命令
1. chmod 命令
权限与数字对应关系： r -4，w -2，x -1
使用数字修改文件权限的命令格式：
chmod 权限值 文件名
若加选项 -R 表示连同子目录中的所有文件，也都修改为设定的权限。
文件的基本权限就是 3 种用户身份，所有者 u，所属组 g 和其他人 o 。a 代表全部的身份。
chmod go+/-/=rwx
2. umask 命令
使用 umask 默认权限来给所有新建的文件和目录赋予初始权限。
直接通过 umask 命令得知默认权限的值！
默认是 0022，第 1 个数代表的是文件所具有的特殊权限，后 3 位才是要用到的 umask 值，
转变为字母形式是----w--w-。
文件和目录的真正初始权限可通过以下计算得到：
文件（或目录）的初始权限=文件（或目录）的最大默认权限-umask 权限
Linux 系统中，文件的最大默认权限为 666，即 rw-rw-rw-。
目录的最大默认权限是 777，即 rwxrwxrwx。
注：用字母形式做减法！最大默认权限中 和 umask 权限公共的部分，通过减法运算被遮盖
掉，剩下的最大默认权限，才是最终赋予文件目录的初始权限。如 666-033=644
3. chown 命令
用于修改文件（或目录）的所有者。基本格式：
chown 所有者 文件或目录
-R 表示连同子目录中的所有文件都更改。
若要同时更改所有者和所属组
chown 所有者：所属组 文件或目录
4. chgrp 命令
用于修改文件（或目录）的所属组。
chgrp 所属组 文件名（目录名）